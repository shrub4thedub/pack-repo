[data -c pkg]
  name     crystal-orb
  desc     Discord bot for RSS news feeds from Linux/tech sources
  ver      latest
  src-type git
  src-url  https://github.com/cr33dev/news-feed-discord-bot-for-linux.git
  src-ref  HEAD
  bin      main.py
  license  unknown
end

[fn check_deps]
  echo "Checking dependencies..."
  
  # Check for Python 3
  run which python3
  echo "✓ Python 3 found"
  
  # Check for pip
  run which pip3
  echo "✓ pip3 found"
end

[fn install]
  echo "Installing crystal-orb..."
  env HOME
  set home ${_env_result}
  set shelf_dir "${home}/.pack/shelf/crystal-orb"
  set bin_dir "${home}/.local/bin"
  
  # Create directories
  mkdir ${shelf_dir}
  mkdir ${bin_dir}
  
  # Clone directly to shelf directory
  run git clone --depth=1 https://github.com/cr33dev/news-feed-discord-bot-for-linux.git ${shelf_dir}
  
  # Install Python dependencies
  run pip3 install --user discord.py feedparser requests
  
  echo "Installed crystal-orb to ${shelf_dir}"
  echo "Edit the bot configuration in main.py and run: cd ${shelf_dir} && python3 main.py"
end

[fn -i uninstall]
  echo "Uninstalling crystal-orb..."
  env HOME
  set home ${_env_result}
  set shelf_dir "${home}/.pack/shelf/crystal-orb"
  
  # Remove shelf directory
  if exists ${shelf_dir}
    delete ${shelf_dir}
    echo "removed shelf directory ${shelf_dir}"
  end
  
  echo "crystal-orb uninstalled successfully"
end

[main]
  check_deps
  install
end